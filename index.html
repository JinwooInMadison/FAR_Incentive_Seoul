<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <title>ì„œìš¸ì‹œ ìš©ì ë¥  ì¸ì„¼í‹°ë¸Œ ì§€ë„</title>
    <style>
        /* [ê¸°ì¡´] ì›ë³¸ ì§€ë„ ìŠ¤íƒ€ì¼ ìœ ì§€ */
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; font-family: 'Malgun Gothic', sans-serif; }
        #map { width: 100%; height: 100vh; position: relative; z-index: 0; }
        
       .search-container {
            position: absolute; top: 20px; left: 20px; z-index: 100;
            background: white; padding: 10px; border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2); display: flex; gap: 5px;
        }
        #address-input { width: 250px; padding: 8px; border: 1px solid #ccc; border-radius: 4px; outline: none; }
        #search-btn { padding: 8px 15px; background: #ff5722; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }

        /* [ì¶”ê°€] ë²•ë ¹ í™•ì¸ ë²„íŠ¼ (ìš°ì¸¡ ìƒë‹¨ ë°°ì¹˜) */
        #openLawBtn {
            position: absolute; top: 20px; right: 20px; z-index: 100;
            padding: 12px 20px; background-color: #2c3e50; color: white; 
            border: none; border-radius: 8px; cursor: pointer; font-weight: bold;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        /* [ì¶”ê°€] ëª¨ë‹¬(íŒì—…) ìŠ¤íƒ€ì¼ */
       .modal {
            display: none; position: fixed; z-index: 10000; left: 0; top: 0;
            width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.7);
        }
       .modal-content {
            background-color: #f4f7f6; margin: 3% auto; padding: 0; border: none;
            width: 90%; max-width: 800px; border-radius: 12px; box-shadow: 0 5px 30px rgba(0,0,0,0.3);
        }
       .modal-header { background-color: #2c3e50; padding: 15px 25px; border-radius: 12px 12px 0 0; }
       .close-btn { color: #fff; float: right; font-size: 30px; font-weight: bold; cursor: pointer; }
       .modal-body { padding: 25px; max-height: 70vh; overflow-y: auto; color: #333; }
       .law-section { margin-bottom: 25px; }
       .section-title { font-size: 17px; color: #2c3e50; border-left: 5px solid #3498db; padding-left: 10px; margin-bottom: 12px; font-weight: bold; }
       .law-text { background: #fff; padding: 12px; border: 1px solid #dee2e6; border-radius: 6px; line-height: 1.7; font-size: 14px; }
       .law-table { width: 100%; border-collapse: collapse; margin-bottom: 10px; background: #fff; text-align: center; }
       .law-table th,.law-table td { border: 1px solid #e0e0e0; padding: 10px; font-size: 13px; }
       .law-table th { background-color: #f8f9fa; }
       .highlight-box { background-color: #fff3cd; border: 1px solid #ffeeba; padding: 12px; border-radius: 6px; color: #856404; font-size: 14px; }
       .deadline { color: #e74c3c; font-weight: bold; }
    </style>
    <script type="text/javascript" src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=105hwwmu52&submodules=cadastral,geocoder&callback=initMap"></script>
</head>
<body>

    <div class="search-container">
        <input type="text" id="address-input" placeholder="ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: íš¨ì œë™ 69-4)">
        <button id="search-btn">ê²€ìƒ‰</button>
    </div>

    <button id="openLawBtn">ë²•ë ¹ ë° ì¸ì„¼í‹°ë¸Œ í™•ì¸</button>

    <div id="map"></div>

    <div id="lawModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="close-btn">&times;</span>
                <h2 style="margin: 0; color: #fff; font-size: 18px;">ì„œìš¸íŠ¹ë³„ì‹œ ë„ì‹œê³„íš ì¡°ë¡€ ë° ì¸ì„¼í‹°ë¸Œ ë²•ë ¹</h2>
            </div>
            <div class="modal-body">
                <section class="law-section">
                    <h3 class="section-title">ê´€ê´‘ìˆ™ë°• íŠ¹í™”êµ¬ì—­ ë‚´ ê±´ì¶• ê·œì œ ì™„í™”</h3>
                    <table class="law-table">
                        <tr><th>ì™„í™” ì‚¬í•­</th><th>ì™„í™” ë²”ìœ„ (ì¸ì„¼í‹°ë¸Œ)</th></tr>
                        <tr><td><b>ê±´íìœ¨</b></td><td>ã€Œêµ­í† ê³„íšë²• ì‹œí–‰ë ¹ã€ ì œ46ì¡°ì œ4í•­ í—ˆìš© ë²”ìœ„ ì´ë‚´</td></tr>
                        <tr><td><b>ë†’ì´</b></td><td>ì§€êµ¬ë‹¨ìœ„ê³„íš ê²°ì • <b>ìµœê³ ë†’ì´ì˜ 1.3ë°°</b> ì´ë‚´</td></tr>
                        <tr><td><b>ìµœëŒ€ê°œë°œê·œëª¨</b></td><td>ì§€êµ¬ë‹¨ìœ„ê³„íš ê²°ì • <b>ìµœëŒ€ê°œë°œê·œëª¨ ë¯¸ì ìš©</b></td></tr>
                    </table>
                    <div class="highlight-box">
                        <b>ğŸ’¡ ëª¨í…” ì „í™˜ íŠ¹ë¡€:</b> ê¸°ì¡´ ëª¨í…”ì„ ê´€ê´‘ìˆ™ë°•ì‹œì„¤ë¡œ ê°œë°œ ì‹œ <b>ê±´íìœ¨ê³¼ ë†’ì´ì˜ ì¤‘ë³µ ì ìš© ê°€ëŠ¥</b>
                    </div>
                </section>

                <section class="law-section">
                    <h3 class="section-title">ì„œìš¸íŠ¹ë³„ì‹œ ë„ì‹œê³„íš ì¡°ë¡€ ì œ51ì¡° (ìš©ì ë¥ ì˜ ì™„í™”)</h3>
                    <div class="law-text">
                        <p><b>ì œ1í˜¸ ë‹¤ëª©:</b> ê´€ê´‘í˜¸í…”, ê°€ì¡±í˜¸í…”, í˜¸ìŠ¤í…”ì—… ì‹œì„¤ ê±´ì¶• ì‹œ í•´ë‹¹ ìš©ë„ì§€ì—­ ìš©ì ë¥ ì˜ 120% ì´í•˜. <b>(ë‹¨, ê´€ê´‘ìˆ™ë°• íŠ¹í™”êµ¬ì—­ì€ 130% ì´í•˜ ë²”ìœ„ê¹Œì§€ ì™„í™”)</b></p>
                        <p><b>ì œ1í˜¸ ì‚¬ëª© (ë„ì‹¬ íŠ¹ë¡€):</b></p>
                        <ul>
                            <li>ì„œìš¸ë„ì‹¬ ì™¸ ì§€ì—­: í•´ë‹¹ ìš©ë„ì§€ì—­ ìš©ì ë¥ ì˜ <b>130% ì´í•˜</b></li>
                            <li>ì„œìš¸ë„ì‹¬ ì§€ì—­: ì„œìš¸ë„ì‹¬ ì™¸ ìš©ì ë¥ (800%)ì˜ <b>130% ì´í•˜ (ìµœëŒ€ 1,040%)</b></li>
                        </ul>
                    </div>
                </section>

                <section class="law-section">
                    <h3 class="section-title">ì¡°ë¡€ ì œ48ì¡° (ê¸°ë³¸ ìš©ì ë¥  ìƒí•œ)</h3>
                    <table class="law-table">
                        <tr><th>ìš©ë„ì§€ì—­ êµ¬ë¶„</th><th>ì„œìš¸ë„ì‹¬ ì™¸</th><th>ì„œìš¸ë„ì‹¬ ë‚´</th></tr>
                        <tr><td>ì¼ë°˜ìƒì—…ì§€ì—­</td><td>800%</td><td>600% (ì¸ì„¼í‹°ë¸Œ ì‹œ 1,040%)</td></tr>
                        <tr><td>ê·¼ë¦°ìƒì—…ì§€ì—­</td><td>600%</td><td>500% (ì¸ì„¼í‹°ë¸Œ ì‹œ 780%)</td></tr>
                    </table>
                </section>

                <p style="text-align: center; font-size: 14px; color: #666; border-top: 1px dashed #ccc; padding-top: 15px;">
                    ğŸ“… ìœ íš¨ê¸°ê°„: <span class="deadline">2029ë…„ 1ì›” 4ì¼</span> ê±´ì¶•í—ˆê°€ ì‹ ì²­ë¶„ê¹Œì§€ ì ìš©
                </p>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        var map = null;
        var infoWindow = null;
        var searchMarker = null;

        // [ê¸°ì¡´] ì§€ë„ ì´ˆê¸°í™” ë° ë°ì´í„° ë¡œë“œ í•¨ìˆ˜ (ì›ë³¸ ë¡œì§ ë³´ì¡´)
        function initMap() {
            // 1. ì§€ë„ ì´ˆê¸°í™”
            map = new naver.maps.Map('map', {
                center: new naver.maps.LatLng(37.541, 126.986), 
                zoom: 13 
            });

            // 2. ì§€ì í¸ì§‘ë„ ë ˆì´ì–´ ì¶”ê°€
            var cadastralLayer = new naver.maps.CadastralLayer();
            cadastralLayer.setMap(map);

            // 3. êµ¬ì—­ ìŠ¤íƒ€ì¼ ì„¤ì • (63ê°œ êµ¬ì—­)
            map.data.setStyle(function(feature) {
                return {
                    fillColor: '#ff5722', fillOpacity: 0.20,
                    strokeColor: '#ff5722', strokeWeight: 1.5, clickable: true
                };
            });

            // 4. GeoJSON ë°ì´í„° ì£¼ì… (ê¸°ì¡´ íŒŒì¼ëª… ìœ ì§€)
            fetch('./Seoul_Planning_63.geojson')
               .then(res => res.json())
               .then(json => { map.data.addGeoJson(json); console.log("63ê°œ êµ¬ì—­ ë¡œë“œ ì™„ë£Œ"); })
               .catch(err => console.error("ë°ì´í„° ë¡œë“œ ì¤‘ ì—ëŸ¬:", err));

            // 5. ì •ë³´ì°½ ê°ì²´ ìƒì„±
            infoWindow = new naver.maps.InfoWindow({
                content: '', backgroundColor: "#fff", borderColor: "#ff5722", borderWidth: 2
            });

            // 6. í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            map.data.addListener('click', function(e) {
                var name = e.feature.getProperty('DGM_NM'); 
                infoWindow.setContent('<div style="padding:10px; font-size:13px;"><b>êµ¬ì—­ëª…:</b> ' + name + '</div>');
                infoWindow.open(map, e.coord); 
            });

            // 7. ì£¼ì†Œ ê²€ìƒ‰ ê¸°ëŠ¥ (ì˜¤ë¥˜ ìˆ˜ì •: ì¸ë±ìŠ¤  ì¶”ê°€)
            function searchAddress() {
                var address = document.getElementById('address-input').value;
                if (!address) return alert('ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');

                naver.maps.Service.geocode({ query: address }, function(status, response) {
                    if (status!== naver.maps.Service.Status.OK) return alert('ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.');

                    var result = response.v2.addresses; // ì¸ë±ìŠ¤ ë³µêµ¬
                    var coords = new naver.maps.LatLng(result.y, result.x);

                    if (searchMarker) searchMarker.setMap(null);
                    map.setCenter(coords);
                    map.setZoom(18); 

                    searchMarker = new naver.maps.Marker({
                        position: coords, map: map, animation: naver.maps.Animation.DROP
                    });
                });
            }

            // 8. ì§€ë„ ë¹ˆ ê³µê°„ í´ë¦­ ì‹œ ì´ˆê¸°í™”
            naver.maps.Event.addListener(map, 'click', function(e) {
                if (searchMarker) { searchMarker.setMap(null); searchMarker = null; }
                if (infoWindow) { infoWindow.close(); }
            });

            // [ê¸°ì¡´] ì´ë²¤íŠ¸ ì—°ê²° ì½”ë“œ ìœ ì§€
            document.getElementById('search-btn').addEventListener('click', searchAddress);
            document.getElementById('address-input').addEventListener('keydown', function(e) {
                if(e.keyCode === 13) searchAddress();
            });

            // --- [ì¶”ê°€] íŒì—… ì œì–´ ë¡œì§ ---
            const modal = document.getElementById("lawModal");
            const btn = document.getElementById("openLawBtn");
            const closeBtn = document.querySelector(".close-btn");

            btn.onclick = () => modal.style.display = "block";
            closeBtn.onclick = () => modal.style.display = "none";
            window.onclick = (e) => { if (e.target == modal) modal.style.display = "none"; }
        }
    </script>
</body>
</html>
